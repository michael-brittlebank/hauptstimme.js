<html>
<head>
    <title>Chorus.js</title>
    <script src="/chorus.min.js"></script>
    <link rel="stylesheet" type="text/css" href="/chorus.min.css">
    <link rel="stylesheet" type="text/css" href="/chorus.min.css.map">
</head>
<div class="my-class-name">
    class
</div>
<div class="my-class-name">
    class
</div>
<div id="my-id-name">
    id
</div>
<h2 class="chorus-standard-font">Results: Scales</h2>
<div id="results-scales" class="results-container">
</div>
<h2 class="chorus-standard-font">Results: Chords</h2>
<div id="results-chords" class="results-container">
</div>
<a onclick="_chorus.search();" class="chorus-search-button">search for scales and chords</a>
<a onclick="_chorus.clear();" class="chorus-search-button">Clear Chorus Results</a>
<script>
    document.addEventListener('DOMContentLoaded', function(e) {
        var config = {
            layoutInstrument: 'piano',
            chorusDebug:'console',
            searchText: 'My Search Button',
            searchCallback: 'myCallbackFunction',
            flattenSearchResults: true
        };
        _chorus.init('my-class-name', config);
        config = {
            layoutInstrument: ['violin','main'],
            chorusDebug:'console',
            layoutInstrumentTitles:true,
            layoutInstrumentTitleElement:'h3',
            layoutContainerId: 'myId',
            layoutContainerClass: 'myClassName',
            multicolor: true
        };
        _chorus.init('my-id-name', config);
    });
    document.addEventListener('chorusInitComplete', function(e) {
        console.log(e.detail);
    });
    document.addEventListener('chorusSearchComplete', function(e) {
        console.log('search complete');
        console.log(_chorus.searchResult);
        setTimeout(function(){
            //todo, determine why directly chaining _chorus methods does not work
            _chorus.populateLists('results-scales','results-chords');
        },100);
    });
    function myCallbackFunction(results){
        console.log('you called me back!');
        console.log(results);
        setTimeout(function(){
            //todo, determine why directly chaining _chorus methods does not work
            applyResults();
        },100);
    }
    function applyResults(){
        if (_chorus.searchResult.scales.resultsArray.hasOwnProperty('main')){
            _chorus.applyResults(_chorus.searchResult.scales.resultsArray.main[0].tones,_chorus.searchResult.containers);
        } else if (_chorus.searchResult.scales.resultsArray.length > 0){
            _chorus.applyResults(_chorus.searchResult.scales.resultsArray[0].tones,_chorus.searchResult.containers);
        }
    }
</script>
</html>