var _chorus=window.chorus=_chorus||window.chorus||{};_chorus.version=_chorus.version||{version:"0.4",lastUpdated:(new Date).toDateString()},_chorus.searchResult={scales:{},chords:{}},_chorus.defaultConfig={instrument:"main",hideHeadings:!1,headingElement:"h2",stringOrder:"desc",containerId:"",scaleSearchButton:!0,scaleSearchText:"Search Scales",scaleSearchCallback:"",debug:"none"},_chorus.config={},_chorus.init=_chorus.init||function(a,b){if(_chorus.events.listeners.init(),_chorus.config=_chorus.logic.helpers.cloneObject(_chorus.defaultConfig),void 0!==b)for(var c in b)b.hasOwnProperty(c)&&_chorus.config.hasOwnProperty(c)&&(_chorus.config[c]=b[c]);if(void 0===a)return _chorus.events.messages.sendMessage(_chorus.data.dictionary.error_undefined+"no element defined in init"),!1;if(null!==document.getElementById(a))_chorus.layout.init(document.getElementById(a)),_chorus.events.dispatchEvent("chorusInitComplete","chorusJS has finished initialization");else{if(!(document.getElementsByClassName(a).length>0))return _chorus.events.messages.sendMessage(_chorus.data.dictionary.error_notFound+"no elements found using init value"),!1;[].forEach.call(document.getElementsByClassName(a),function(a){_chorus.layout.init(a)}),_chorus.events.dispatchEvent("chorusInitComplete","chorusJS has finished initialization")}},_chorus.data=_chorus.data||{},_chorus.logic=_chorus.logic||{},String.prototype.capitalize=function(){return this.toLowerCase().replace(/\b\w/g,function(a){return a.toUpperCase()})},_chorus.events=_chorus.events||{sendChorusLoaded:function(){document.dispatchEvent(new CustomEvent("chorusLoaded",{detail:"ChorusJS: finished initialization"}))},dispatchEvent:function(a,b){var c;document.createEvent?(c=document.createEvent("HTMLEvents"),c.initEvent(a,!0,!0),c.detail=b):(c=document.createEventObject(),c.eventType=a,c.detail=b),c.eventName=a,document.createEvent?document.dispatchEvent(c):document.fireEvent("on"+c.eventType,c)}},_chorus.layout=_chorus.layout||{init:function(a){var b,c=_chorus.config.instrument,d=_chorus.logic.helpers.getConfigValue("containerId");if(b=d.length>0?d:_chorus.logic.helpers.generateRandomString(5),"string"==typeof c)a.innerHTML=_chorus.layout.selectInstrument(c,b);else if(Array.isArray(c)){for(var e="",f=1,g=0;g<c.length;g++){var h=0;switch(c[g]){case"all":h=_chorus.data.instruments.count.all;break;case"main":h=_chorus.data.instruments.count.main;break;case"alternate":h=_chorus.data.instruments.count.alternateGuitar}e+=_chorus.layout.selectInstrument(c[g],b,f),f+=h>0?h:1}a.innerHTML=e}else _chorus.events.messages.sendMessage(_chorus.data.dictionary.error_type+"instrument config parameter")},selectInstrument:function(a,b,c){var d,e="";switch(c||(c=0),a){case"all":for(d in _chorus.data.instruments.main)_chorus.data.instruments.main.hasOwnProperty(d)&&(e+=_chorus.layout.html.instrument(d,_chorus.data.instruments.main[d],_chorus.layout.prefixBuilder(b,c)),c++);for(d in _chorus.data.instruments.other)_chorus.data.instruments.other.hasOwnProperty(d)&&(e+=_chorus.layout.html.instrument(d,_chorus.data.instruments.other[d],_chorus.layout.prefixBuilder(b,c)),c++);break;case"main":for(d in _chorus.data.instruments.main)_chorus.data.instruments.main.hasOwnProperty(d)&&(e+=_chorus.layout.html.instrument(d,_chorus.data.instruments.main[d],_chorus.layout.prefixBuilder(b,c)),c++);break;case"alternate":for(d in _chorus.data.instruments.alternateGuitar)_chorus.data.instruments.alternateGuitar.hasOwnProperty(d)&&(e+=_chorus.layout.html.instrument(d,_chorus.data.instruments.alternateGuitar[d],_chorus.layout.prefixBuilder(b,c)),c++);break;default:_chorus.data.instruments.main.hasOwnProperty(a)?(e=_chorus.layout.html.instrument(a,_chorus.data.instruments.main[a],_chorus.layout.prefixBuilder(b,c)),c++):_chorus.data.instruments.other.hasOwnProperty(a)?(e=_chorus.layout.html.instrument(a,_chorus.data.instruments.other[a],_chorus.layout.prefixBuilder(b,c)),c++):_chorus.data.instruments.alternateGuitar.hasOwnProperty(a)&&(e=_chorus.layout.html.instrument(a,_chorus.data.instruments.alternateGuitar[a],_chorus.layout.prefixBuilder(b,c)),c++)}return e},prefixBuilder:function(a,b){return b.length>0||b>0?a+"-"+b:a}},_chorus.layout.css=_chorus.layout.css||{toBlock:function(){return"hello"}},_chorus.data.dictionary=_chorus.data.dictionary||{class_selected:"fret-selected",class_root:"fret-root",class_string:"string",class_fret:"fret",class_instrument:"chorus_instrument",class_container:"_container",error_type:"[Error] Invalid type: ",error_undefined:"[Error] Undefined: ",error_notFound:"[Error] Not Found: "},_chorus.data.instruments={count:{all:89,main:2,other:41,alternateGuitar:46},main:{guitar:[7,0,5,10,2,7],bass:[7,0,5,10]},other:{violin:[10,5,0,7],violin_tenor:[10,5,0,7],mandolin:[10,5,0,7],ukulele_baritone:[5,10,2,7],ukulele_concert:[10,3,7,0],ukulele_soprano:[0,5,9,2],ukulele_tenor:[10,3,7,0],cello:[3,10,5,0],viola:[3,10,5,0],banjo_plectrum:[3,10,2,5],banjo_tenor_jazz:[3,10,5,0],banjo_tenor_irish:[10,5,0,7],lyre:[0,3,7,10,2,6,9,0],bajo_sexto:[7,0,5,10,2,8],balalaika_alto:[0,0,5],balalaika_soprano:[7,7,0],cuatro:[2,7,0,5,10],cuatro_cubano:[10,3,7,0],dulcimer:[10,3,3,3],dulcimer_alt:[5,5,0,5],mandola:[3,10,5,0],sitar:[3,3,10,3,10,3,8],solo_bass:[9,2,7,0],dobro:[10,2,5,10,2,5],guitarron:[0,5,10,3,7,0],bouzouki:[3,3,8,8,0,0,5,5],bouzouki_alt:[5,5,0,0,5,5],irish_bouzouki:[3,8,0,5],irish_bouzouki_alt:[10,5,0,5],fiddle:[10,5,0,7],vihuela:[0,5,10,2,7],banduria:[11,4,9,2,7,0],charango:[10,3,7,0,7],oud:[10,0,2,7,0,5],oud_alt:[2,9,2,7,0,5],requinto:[0,5,10,3,7,0],lute:[10,10,3,3,8,8,0,0,5,5,10,10],zither:[0,0,5,10,3],russian_guitar:[5,10,2,5,10,2,5],pedal_steel_guitar:[2,5,7,9,11,2,7,11,6,9],pedal_steel_guitar_alt:[3,8,0,3,7,10,0,3,7,5]},alternateGuitar:{major_seconds:[3,5,7,9,10,1],minor_thirds:[3,6,9,0,3,6],major_thirds:[7,11,3,7,11,3],all_fourths:[7,0,5,10,3,8],augmented_fourths:[3,9,3,9,3,9],all_fifths:[3,10,5,0,7,2],baritone:[2,7,0,5,9,2],baritone_alt:[0,5,10,3,7,0],hawaiian:[7,0,7,0,4,7],new_standard:[3,10,5,0,7,10],resophonic:[10,2,5,10,2,5],tenor:[3,10,5,0],open_a:[7,0,4,7,0,7],open_b:[2,9,2,9,2,6],open_c:[3,10,3,10,3,7],open_d:[5,0,5,9,0,5],modal_d:[5,0,5,10,0,5],open_d_minor:[5,0,5,8,0,5],open_e:[7,2,7,11,2,7],open_f:[8,0,3,8,0,3],open_g:[5,10,5,10,2,5],modal_g:[5,10,5,10,2,5],open_g_minor:[7,0,4,7,0,7],admiral:[3,10,5,10,2,3],buzzard:[3,8,3,10,1,8],face:[3,10,5,10,0,5],four_and_twenty:[5,0,5,5,0,5],hot_type:[0,2,7,9,0,5],layover:[5,0,3,10,3,7],magic_farmer:[3,8,3,10,0,7],pelican:[5,0,5,7,0,5],processional:[5,10,5,8,0,1],slow_motion:[5,10,5,8,3,5],spirit:[4,0,4,11,0,7],tarboulton:[3,1,3,8,1,8],toulouse:[7,3,5,8,0,5],triqueen:[5,10,5,9,0,2],minor_sixths:[3,11,7,3,11,7],major_sixths:[3,0,9,6,3,0],mandoguitar:[3,10,5,0,7,2],pentatonic:[0,3,5,7,10,0],overtone:[3,7,10,1,3,5],lefty:[7,2,10,5,0,7],cittern:[3,8,3,10,3,5],cittern_alt:[3,10,3,10,3,10],balalaika:[7,0,5,7,7,0]}},_chorus.data.notes={count:{tones:12,letters:7},tone:{0:"A",2:"B",3:"C",5:"D",7:"E",8:"F",10:"G"},letter:{A:0,B:2,C:3,D:5,E:7,F:8,G:10}},_chorus.data.scales=_chorus.data.scales||{count:{main:12,derivatives:12,other:12},main:{major_ionian:[2,2,1,2,2,2,1],dorian:[2,1,2,2,2,1,2],phrygian:[1,2,2,2,1,2,2],lydian:[2,2,2,1,2,2,1],mixolydian:[2,2,1,2,2,1,2],minor_aeolian:[2,1,2,2,1,2,2],locrian:[1,2,2,1,2,2,2]},derivatives:{major_pentatonic:[2,2,3,2,3],minor_pentatonic:[3,2,2,3,2],harmonic_minor:[2,1,2,2,1,3,1],melodic_minor:[2,1,2,2,2,2,1],blues:[3,2,1,1,3,2],mixo_blues:[2,1,1,1,1,1,2,1,2]},other:{diminished_whole_half:[2,1,2,1,2,1,2,1],diminished_half_whole:[1,2,1,2,1,2,1,2],whole_tone:[2,2,2,2,2,2],hungarian_minor:[2,1,3,1,1,3,1],hungarian_gypsy:[2,1,3,1,1,2,2],double_harmonic:[1,3,1,2,1,3,1],enigmatic:[1,3,2,2,2,1,1],altered:[1,2,1,2,2,2,2],major_neapolitan:[1,2,2,2,2,2,1],minor_neapolitan:[1,2,2,2,1,3,1],persian:[1,3,1,1,2,3,1],ukranian_dorian:[2,1,3,1,2,1,2],yo:[2,3,2,2,3]}},_chorus.events.listeners=_chorus.events.listeners||{init:function(){document.addEventListener("chorusInitComplete",function(a){_chorus.events.listeners.addListener("fret","click",_chorus.events.listeners.fretLeftClickHandler),_chorus.events.listeners.addListener("fret","contextmenu",_chorus.events.listeners.fretRightClickHandler)})},addListener:function(a,b,c){for(var d=document.getElementsByClassName(a),e=0;e<d.length;e++)d[e].addEventListener(b,c,!1)},fretRightClickHandler:function(a){a.preventDefault();var b=a.target||a.srcElement;b.classList.remove(_chorus.data.dictionary.class_selected),b.classList.remove(_chorus.data.dictionary.class_root)},fretLeftClickHandler:function(a){a.preventDefault();var b=a.target||a.srcElement,c=_chorus.data.dictionary.class_selected,d=_chorus.data.dictionary.class_root,e=document.getElementById(b.id.substr(0,b.id.indexOf("_"))+_chorus.data.dictionary.class_container),f=e.getElementsByClassName(d);b.classList.contains(c)?(b.classList.remove(c),f.length>0&&(f[0].classList.add(c),f[0].classList.remove(d)),b.classList.add(d)):b.classList.contains(d)?b.classList.remove(d):b.classList.add(c)}},_chorus.events.messages=_chorus.events.messages||{sendMessage:function(a){var b=_chorus.logic.helpers.getConfigValue("debug");switch(b){case"console":console.log("ChorusJS: "+a);break;case"alert":alert("ChorusJS: "+a);break;case"none":break;default:console.log("ChorusJS: "+a)}}},_chorus.layout.html=_chorus.layout.html||{instrument:function(a,b,c){var d=_chorus.logic.helpers.getConfigValue("stringOrder");"asc"==d&&b.reverse();for(var e="",f=0;f<b.length;f++)e=_chorus.layout.html.string(c,b[f],f+1)+e;if(Boolean(_chorus.config.hideHeadings)!==!0){var g=_chorus.logic.helpers.getConfigValue("headingElement");e="<"+g+">"+a.replace(/_/g," ")+"</"+g+">"+e}if(Boolean(_chorus.config.scaleSearchButton)===!0){var h=_chorus.logic.helpers.getConfigValue("scaleSearchText");e+='<a class="searchButton" onclick="_chorus.searchScales(\''+c+_chorus.data.dictionary.class_container+"')\">"+h+"</a>"}return'<div id="'+c+_chorus.data.dictionary.class_container+'" class="'+_chorus.data.dictionary.class_instrument+'">'+e+"</div>"},string:function(a,b,c){for(var d,e,f,g=12,h='<div class="'+_chorus.data.dictionary.class_string+'">',i=0;g>=i;i++)f=(parseInt(b)+i)%_chorus.data.notes.count.tones,d=a+"_"+c+"_"+f,e=_chorus.logic.notes.getNoteByToneDefault(f),h+='<div id="'+d+'" class="'+_chorus.data.dictionary.class_fret+'">'+_chorus.layout.html.htmlFilter(e)+"</div>";return h+"</div>"},htmlFilter:function(a){return a.replace(/#/g,"&#9839;").replace(/b/g,"&#9837;")}},_chorus.logic.helpers=_chorus.logic.helpers||{generateRandomString:function(a){var b;for(b="";b.length<a;)b+=Math.random().toString(36).substr(2,1);return b},cloneObject:function(a,b){if(null==a||"object"!=typeof a)return a;if(a.constructor!=Object&&a.constructor!=Array)return a;if(a.constructor==Date||a.constructor==RegExp||a.constructor==Function||a.constructor==String||a.constructor==Number||a.constructor==Boolean)return new a.constructor(a);b=b||new a.constructor;for(var c in a)b[c]="undefined"==typeof b[c]?_chorus.logic.helpers.cloneObject(a[c],null):b[c];return b},getConfigValue:function(a){return typeof _chorus.config[a]!=typeof _chorus.defaultConfig[a]&&_chorus.events.messages.sendMessage(_chorus.data.dictionary.error_type+" "+a),typeof _chorus.config[a]==typeof _chorus.defaultConfig[a]?_chorus.config[a]:_chorus.defaultConfig[a]},getKeyFromValue:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c}},_chorus.logic.notes=_chorus.logic.notes||{getToneByNote:function(a){var b=_chorus.data.notes.letter[a.substring(0,1)],c=0;for(console.log(b);-1!==a.indexOf("#",c);)c=a.indexOf("#",c),b++;for(c=0;-1!==a.indexOf("b",c);)c=a.indexOf("b",c),b--;return console.log(b),b%12},getNoteByToneDefault:function(a){var b;return b=_chorus.data.notes.tone.hasOwnProperty(a)?_chorus.data.notes.tone[a]:4!==a?_chorus.data.notes.tone[(a+1)%12]+"b":_chorus.data.notes.tone[(a-1)%12]+"#"},getNoteByToneForce:function(a,b){var c=b,d=a-_chorus.logic.notes.getToneByNote(b);if(d>0)for(var e=0;d>e;e++)c+="#";else if(0>d)for(var f=0;d>f;f++)c+="b";return c},getLetterProgression:function(a){var b="ABCDEFG".split(a.replace(/b/g,"").replace(/#/g,"").toUpperCase());return[a].concat(b[1].split(""),b[0].split(""))},findSelectedNotes:function(a){var b=document.getElementById(a),c=[],d=null;if(b){for(var e=0;e<b.childNodes.length;e++)if(b.childNodes[e].classList.contains(_chorus.data.dictionary.class_string)&&b.childNodes[e])for(var f=0;f<b.childNodes[e].childNodes.length;f++)b.childNodes[e].childNodes[f].classList.contains(_chorus.data.dictionary.class_selected)&&c.push(b.childNodes[e].childNodes[f]),b.childNodes[e].childNodes[f].classList.contains(_chorus.data.dictionary.class_root)&&(d=b.childNodes[e].childNodes[f])}else _chorus.events.messages.sendMessage(_chorus.data.dictionary.error_notFound+"no element found to search");return{containerId:a,selectedNotes:c,rootNote:d}}},_chorus.logic.scales=_chorus.logic.scales||{compile:{init:function(){for(var a,b,c,d,e,f,g,h,i={},j=0;j<_chorus.data.notes.count.tones-1;j++){a=_chorus.logic.notes.getNoteByToneDefault(j);for(e in _chorus.data.scales.main)if(_chorus.data.scales.main.hasOwnProperty(e)){f=a+" "+e.replace(/_/g," ").capitalize(),g=_chorus.data.scales.main[e],b=[j],d=[a];for(var k=0;k<g.length-1;k++)c=(b[k]+g[k])%12,b.push(c);for(var l=1;l<g.length;l++)7==g.length?(h=_chorus.logic.notes.getLetterProgression(a),d.push(_chorus.logic.notes.getNoteByToneForce(b[l],h[l]))):d.push(_chorus.logic.notes.getNoteByToneDefault(b[l]));i[f]={tones:b,letters:d}}}return console.log(i),i},construct:function(){}}},_chorus.logic.scales.searchScales=_chorus.searchScales=function(a){var b;if(a&&a.length>0){var c=_chorus.logic.notes.findSelectedNotes(a);console.log("containerid passed"),b=_chorus.logic.scales.scaleDrill(c)}else{for(var d=document.getElementsByClassName(_chorus.data.dictionary.class_instrument),e=[],f=0;f<d.length;f++)e.push(_chorus.logic.notes.findSelectedNotes(d[f].id));console.log("searching across page"),console.log(e)}_chorus.searchResult.scales=b,_chorus.events.dispatchEvent("chorusScaleSearchComplete","chorusJS has finished searching scales")},_chorus.logic.scales.scaleDrill=function(a){console.log(a);var b={containerId:a.containerId,scales:[]};return a.hasOwnProperty("rootNote")&&a.rootNote?console.log("has root note"):(console.log("doesn't have root note"),a.hasOwnProperty("selectedNotes")&&a.selectedNotes),b};