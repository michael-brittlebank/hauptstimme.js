var _chorus=window.chorus=_chorus||window.chorus||{};_chorus.version=_chorus.version||{version:"0.4",lastUpdated:(new Date).toDateString()},_chorus.defaultConfig={instrument:"main",hideHeadings:!1,headingElement:"h2",messages:"none"},_chorus.config={},_chorus.init=_chorus.init||function(a,b){if(_chorus.events.listeners.init(),_chorus.config=_chorus.logic.helpers.cloneObject(_chorus.defaultConfig),void 0!==b)for(var c in b)b.hasOwnProperty(c)&&_chorus.config.hasOwnProperty(c)&&(_chorus.config[c]=b[c]);if(void 0===a)return _chorus.events.messages.sendMessage("no element defined in init"),!1;if(null!==document.getElementById(a))_chorus.layout.init(document.getElementById(a)),_chorus.events.dispatchEvent("chorusInitComplete","chorusJS has finished initialization");else{if(!(document.getElementsByClassName(a).length>0))return _chorus.events.messages.sendMessage("no elements found on page for init"),!1;[].forEach.call(document.getElementsByClassName(a),function(a){_chorus.layout.init(a)}),_chorus.events.dispatchEvent("chorusInitComplete","chorusJS has finished initialization")}},_chorus.data=_chorus.data||{},_chorus.logic=_chorus.logic||{},_chorus.events=_chorus.events||{sendChorusLoaded:function(){document.dispatchEvent(new CustomEvent("chorusLoaded",{detail:"ChorusJS: finished initialization"}))},dispatchEvent:function(a,b){var c;document.createEvent?(c=document.createEvent("HTMLEvents"),c.initEvent(a,!0,!0),c.detail=b):(c=document.createEventObject(),c.eventType=a,c.detail=b),c.eventName=a,document.createEvent?document.dispatchEvent(c):document.fireEvent("on"+c.eventType,c)}},_chorus.layout=_chorus.layout||{init:function(a){var b=_chorus.config.instrument;if("string"==typeof b)a.innerHTML=_chorus.layout.selectInstrument(b);else if(Array.isArray(b)){for(var c="",d=0;d<b.length;d++)c+=_chorus.layout.selectInstrument(b[d]);a.innerHTML=c}else _chorus.events.messages.sendMessage("instrument parameter invalid")},selectInstrument:function(a){var b,c="";switch(a){case"all":for(b in _chorus.data.instruments.main)_chorus.data.instruments.main.hasOwnProperty(b)&&(c+=_chorus.layout.html.instrument(b,_chorus.data.instruments.main[b]));for(b in _chorus.data.instruments.other)_chorus.data.instruments.other.hasOwnProperty(b)&&(c+=_chorus.layout.html.instrument(b,_chorus.data.instruments.other[b]));break;case"main":for(b in _chorus.data.instruments.main)_chorus.data.instruments.main.hasOwnProperty(b)&&(c+=_chorus.layout.html.instrument(b,_chorus.data.instruments.main[b]));break;case"alternate":for(b in _chorus.data.instruments.alternateGuitar)_chorus.data.instruments.alternateGuitar.hasOwnProperty(b)&&(c+=_chorus.layout.html.instrument(b,_chorus.data.instruments.alternateGuitar[b]));break;default:_chorus.data.instruments.main.hasOwnProperty(a)?c=_chorus.layout.html.instrument(a,_chorus.data.instruments.main[a]):_chorus.data.instruments.other.hasOwnProperty(a)?c=_chorus.layout.html.instrument(a,_chorus.data.instruments.other[a]):_chorus.data.instruments.alternateGuitar.hasOwnProperty(a)&&(c=_chorus.layout.html.instrument(a,_chorus.data.instruments.alternateGuitar[a]))}return c}},_chorus.layout.css=_chorus.layout.css||{toBlock:function(){return"hello"}},_chorus.data.dictionaries=_chorus.data.dictionaries||{fretClasses:{selected:"fret-selected",root:"fret-root",string:"string",fret:"fret",instrument:"chorus_instrument",container:"_container"}},_chorus.data.instruments=_chorus.data.instruments||{main:{guitar:"8,1,6,11,3,8",bass:"8,1,6,11"},other:{violin:"11,6,1,8",violin_tenor:"11,6,1,8",mandolin:"11,6,1,8",ukulele_baritone:"6,11,3,8",ukulele_concert:"11,4,8,1",ukulele_soprano:"1,6,10,3",ukulele_tenor:"11,4,8,1",cello:"4,11,6,1",viola:"4,11,6,1",banjo_plectrum:"4,11,3,6",banjo_tenor_jazz:"4,11,6,1",banjo_tenor_irish:"11,6,1,8",lyre:"1,4,8,11,3,7,10,1",bajo_sexto:"8,1,6,11,3,9",balalaika_alto:"1,1,6",balalaika_soprano:"8,8,1",cuatro:"3,8,1,6,11",cuatro_cubano:"11,4,8,1",dulcimer:"11,4,4,4",dulcimer_alt:"6,6,1,6",mandola:"4,11,6,1",sitar:"4,4,11,4,11,4,9",solo_bass:"10,3,8,1",dobro:"11,3,6,11,3,6",guitarron:"1,6,11,4,8,1",bouzouki:"4,4,9,9,1,1,6,6",bouzouki_alt:"6,6,1,1,6,6",irish_bouzouki:"4,9,1,6",irish_bouzouki_alt:"11,6,1,6",fiddle:"11,6,1,8",vihuela:"1,6,11,3,8",banduria:"0,5,10,3,8,1",charango:"11,4,8,1,8",oud:"11,1,3,8,1,6",oud_alt:"3,10,3,8,1,6",requinto:"1,6,11,4,8,1",lute:"11,11,4,4,9,9,1,1,6,6,11,11",zither:"1,1,6,11,4",russian_guitar:"6,11,3,6,11,3,6",pedal_steel_guitar:"3,6,8,10,0,3,8,0,7,10",pedal_steel_guitar_alt:"4,9,1,4,8,11,1,4,8,6"},alternateGuitar:{major_seconds:"4,6,8,10,11,2",minor_thirds:"4,7,10,1,4,7",major_thirds:"8,0,4,8,0,4",all_fourths:"8,1,6,11,4,9",augmented_fourths:"4,10,4,10,4,10",all_fifths:"4,11,6,1,8,3",baritone:"3,8,1,6,10,3",baritone_alt:"1,6,11,4,8,1",hawaiian:"8,1,8,1,5,8",new_standard:"4,11,6,1,8,11",resophonic:"11,3,6,11,3,6",tenor:"4,11,6,1",open_a:"8,1,5,8,1,8",open_b:"3,10,3,10,3,7",open_c:"4,11,4,11,4,8",open_d:"6,1,6,10,1,6",modal_d:"6,1,6,11,1,6",open_d_minor:"6,1,6,9,1,6",open_e:"8,3,8,0,3,8",open_f:"9,1,4,9,1,4",open_g:"6,11,6,11,3,6",modal_g:"6,11,6,11,3,6",open_g_minor:"8,1,5,8,1,8",admiral:"4,11,6,11,3,4",buzzard:"4,9,4,11,2,9",face:"4,11,6,11,1,6",four_and_twenty:"6,1,6,6,1,6",hot_type:"1,3,8,10,1,6",layover:"6,1,4,11,4,8",magic_farmer:"4,9,4,11,1,8",pelican:"6,1,6,8,1,6",processional:"6,11,6,9,1,2",slow_motion:"6,11,6,9,4,6",spirit:"5,1,5,0,1,8",tarboulton:"4,2,4,9,2,9",toulouse:"8,4,6,9,1,6",triqueen:"6,11,6,10,1,3",minor_sixths:"4,0,8,4,0,8",major_sixths:"4,1,10,7,4,1",mandoguitar:"4,11,6,1,8,3",pentatonic:"1,4,6,8,11,1",overtone:"4,8,11,2,4,6",lefty:"8,3,11,6,1,8",cittern:"4,9,4,11,4,6",cittern_alt:"4,11,4,11,4,11",balalaika:"8,1,6,8,8,1"}},_chorus.data.notes=_chorus.data.notes||{0:"Ab",1:"A",2:"Bb",3:"B",4:"C",5:"C#",6:"D",7:"Eb",8:"E",9:"F",10:"Gb",11:"G"},_chorus.data.scales=_chorus.data.scales||{main:{Major_Ionian:"2212221",Dorian:"2122212",Phrygian:"1222122",Lydian:"2221221",Mixolydian:"2212212",Minor_Aeolian:"2122122",Locrian:"1221222"},derivatives:{Major_Pentatonic:"22323",Minor_Pentatonic:"32232",Harmonic_Minor:"2122131",Melodic_Minor:"2122221",Blues:"321132",Mixo_Blues:"211111212"},other:{Diminished_Whole_Half:"21212121",Diminished_Half_Whole:"12121212",Whole_Tone:"222222",Hungarian_Minor:"2131131",Hungarian_Gypsy:"2131122",Double_Harmonic:"1312131",Enigmatic:"1322211",Altered:"1212222",Major_Neapolitan:"1222221",Minor_Neapolitan:"1222131",Persian:"1311231",Ukranian_Dorian:"2131212",Yo:"23223"}},_chorus.events.listeners=_chorus.events.listeners||{init:function(){document.addEventListener("chorusInitComplete",function(a){_chorus.events.listeners.addListener("fret","click",_chorus.events.listeners.fretLeftClickHandler),_chorus.events.listeners.addListener("fret","contextmenu",_chorus.events.listeners.fretRightClickHandler)})},addListener:function(a,b,c){for(var d=document.getElementsByClassName(a),e=0;e<d.length;e++)d[e].addEventListener(b,c,!1)},fretRightClickHandler:function(a){a.preventDefault();var b=a.target||a.srcElement;b.classList.remove(_chorus.data.dictionaries.fretClasses.selected),b.classList.remove(_chorus.data.dictionaries.fretClasses.root)},fretLeftClickHandler:function(a){a.preventDefault();var b=a.target||a.srcElement,c=_chorus.data.dictionaries.fretClasses.selected,d=_chorus.data.dictionaries.fretClasses.root,e=document.getElementById(b.id.substr(0,b.id.indexOf("_"))+_chorus.data.dictionaries.fretClasses.container),f=e.getElementsByClassName(d);b.classList.contains(c)?(b.classList.remove(c),f.length>0&&(f[0].classList.add(c),f[0].classList.remove(d)),b.classList.add(d)):b.classList.contains(d)?b.classList.remove(d):b.classList.add(c)}},_chorus.events.messages=_chorus.events.messages||{sendMessage:function(a){var b="string"==typeof _chorus.config.messages?_chorus.config.messages:_chorus.defaultConfig.messages;switch(b){case"console":console.log("ChorusJS: "+a);break;case"alert":alert("ChorusJS: "+a);break;case"none":break;default:console.log("ChorusJS: "+a)}}},_chorus.layout.html=_chorus.layout.html||{instrument:function(a,b){for(var c=_chorus.logic.helpers.generateRandomString(5),d=b.split(","),e="",f=0;f<d.length;f++)e=_chorus.layout.html.string(c,d[f],f+1)+e;if(Boolean(_chorus.config.hideHeadings)!==!0){var g="string"==typeof _chorus.config.headingElement?_chorus.config.headingElement:_chorus.defaultConfig.headingElement;e="<"+g+">"+a.replace(/_/g," ")+"</"+g+">"+e}return'<div id="'+c+_chorus.data.dictionaries.fretClasses.container+'" class="'+_chorus.data.dictionaries.fretClasses.instrument+'">'+e+"</div>"},string:function(a,b,c){for(var d,e,f,g='<div class="'+_chorus.data.dictionaries.fretClasses.string+'">',h=0;12>=h;h++)f=(parseInt(b)+h)%12,d=a+"_"+c+"_"+f,e=_chorus.logic.notes.getNoteById(f),g+='<div id="'+d+'" class="'+_chorus.data.dictionaries.fretClasses.fret+'">'+_chorus.layout.html.htmlFilter(e)+"</div>";return g+"</div>"},htmlFilter:function(a){return a.replace(/#/g,"&#9839;").replace(/b/g,"&#9837;")}},_chorus.logic.helpers=_chorus.logic.helpers||{generateRandomString:function(a){var b;for(b="";b.length<a;)b+=Math.random().toString(36).substr(2,1);return b},cloneObject:function(a,b){if(null==a||"object"!=typeof a)return a;if(a.constructor!=Object&&a.constructor!=Array)return a;if(a.constructor==Date||a.constructor==RegExp||a.constructor==Function||a.constructor==String||a.constructor==Number||a.constructor==Boolean)return new a.constructor(a);b=b||new a.constructor;for(var c in a)b[c]="undefined"==typeof b[c]?_chorus.logic.helpers.cloneObject(a[c],null):b[c];return b}},_chorus.logic.notes=_chorus.logic.notes||{getNoteById:function(a){return a>=0&&12>a?String(_chorus.data.notes[a]):!1},getNoteByName:function(a){for(var b in _chorus.data.notes)if(_chorus.data.notes.hasOwnProperty(b)&&_chorus.data.notes[b].toLowerCase()===a.toLowerCase())return b;return!1},findSelectedNotes:function(a){var b=document.getElementById(a),c=[],d=null;if(b){for(var e=0;e<b.childNodes.length;e++)if(b.childNodes[e].classList.contains(_chorus.data.dictionaries.fretClasses.string)&&b.childNodes[e])for(var f=0;f<b.childNodes[e].childNodes.length;f++)b.childNodes[e].childNodes[f].classList.contains(_chorus.data.dictionaries.fretClasses.selected)&&c.push(b.childNodes[e].childNodes[f]),b.childNodes[e].childNodes[f].classList.contains(_chorus.data.dictionaries.fretClasses.root)&&(d=b.childNodes[e].childNodes[f])}else _chorus.events.messages.sendMessage("no element found to search");return{containerId:a,selectedNotes:c,rootNote:d}}},_chorus.logic.scales=_chorus.logic.scales||{},_chorus.logic.scales.searchScales=_chorus.searchScales=function(a){if(a&&a.length>0){var b=_chorus.logic.notes.findSelectedNotes(a);console.log("id results"),console.log(b)}else{for(var c=document.getElementsByClassName(_chorus.data.dictionaries.fretClasses.instrument),d=[],e=0;e<c.length;e++)console.log(c[e].id),d.push(_chorus.logic.notes.findSelectedNotes(c[e].id));console.log("class results"),console.log(d)}};